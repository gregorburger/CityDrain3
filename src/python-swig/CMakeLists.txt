include(${SWIG_USE_FILE})
execute_process(COMMAND ${SWIG_EXECUTABLE} -python -threads -external-runtime swigruntime.h)

ADD_CUSTOM_COMMAND(
	OUTPUT ${CMAKE_BINARY_DIR}/pycd3WRAP.cpp
        COMMAND ${SWIG_EXECUTABLE} -python -threads -c++ -o ${CMAKE_BINARY_DIR}/pycd3WRAP.cpp ${CMAKE_CURRENT_SOURCE_DIR}/pycd3.i
	DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/pycd3.i
	)

ADD_CUSTOM_TARGET(pycd3gen DEPENDS ${CMAKE_BINARY_DIR}/pycd3WRAP.cpp)

SET_SOURCE_FILES_PROPERTIES(pycd3.i PROPERTIES CPLUSPLUS ON)
SET_SOURCE_FILES_PROPERTIES(pycd3.i PROPERTIES SWIG_FLAGS "-threads")
SWIG_ADD_MODULE(pycd3 python pycd3.i)
SWIG_LINK_LIBRARIES(pycd3 cd3core ${PYTHON_LIBRARIES})
